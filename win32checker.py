#!/usr/bin/env python3
import os
import re
import argparse
from pathlib import Path

# Common Win32 headers and functions (partial list - should be expanded)
WIN32_HEADERS = {
    'windows.h', 'winbase.h', 'winuser.h', 'wingdi.h', 'winsock2.h',
    'winreg.h', 'winnt.h', 'winerror.h', 'wtypes.h', 'shlobj.h'
}

WIN32_FUNCTIONS = {
   "_TrackMouseEvent",
   "AbnormalTermination",
   "AbortDoc",
   "AbortPath",
   "AbortPrinter",
   "AbortProc",
   "AbortSystemShutdown",
   "AccessNtmsLibraryDoor",
   "AcquireSRWLockExclusive",
   "AcquireSRWLockShared",
   "ActivateKeyboardLayout",
   "AddAtom",
   "AddClipboardFormatListener",
   "AddERExcludedApplication",
   "AddFontMemResourceEx",
   "AddFontResource",
   "AddFontResourceEx",
   "AddForm",
   "AddJob",
   "AddMonitor",
   "AddNtmsMediaType",
   "AddPort",
   "AddPrinter",
   "AddPrinterConnection",
   "AddPrinterDriver",
   "AddPrinterDriverEx",
   "AddPrintProcessor"
   "AddPrintProvidor",
   "AddSIDToBoundaryDescriptor",
   "AddUsersToEncryptedFile",
   "AddVectoredExceptionHandler",
   "AdjustWindowRect",
   "AdjustWindowRectEx",
   "AdvancedDocumentProperties",
   "AlertSamplesAvail",
   "AllocateNtmsMedia",
   "AllocateUserPhysicalPages",
   "AllocateUserPhysicalPagesNuma",
   "AllocConsole",
   "AllowSetForegroundWindow",
   "AlphaBlend",
   "AngleArc",
   "AnimatePalette",
   "AnimateWindow",
   "AnyPopup",
   "APCProc",
   "AppendMenu",
   "ApplicationRecoveryFinished",
   "ApplicationRecoveryInProgress",
   "Arc",
   "ArcTo",
   "AreFileApisANSI",
   "ArrangeIconicWindows",
   "AssignProcessToJobObject",
   "AttachConsole",
   "AttachThreadInput",
   "AvQuerySystemResponsiveness",
   "AvRevertMmThreadCharacteristics",
   "AvRtCreateThreadOrderingGroup",
   "AvRtCreateThreadOrderingGroupEx",
   "AvRtDeleteThreadOrderingGroup",
   "AvRtJoinThreadOrderingGroup",
   "AvRtLeaveThreadOrderingGroup",
   "AvRtWaitOnThreadOrderingGroup",
   "AvSetMmMaxThreadCharacteristics",
   "AvSetMmThreadCharacteristics",
   "AvSetMmThreadPriority",
   "BackupEventLog",
   "BackupRead",
   "BackupSeek",
   "BackupWrite",
   "Beep",
   "BeginDeferWindowPos",
   "BeginNtmsDeviceChangeDetection",
   "BeginPaint",
   "BeginPath",
   "BeginUpdateResource",
   "BindIoCompletionCallback",
   "BitBlt",
   "BlockInput",
   "BringWindowToTop",
   "BroadcastSystemMessage",
   "BroadcastSystemMessageEx",
   "BufferCallback",
   "BuildCommDCB",
   "BuildCommDCBAndTimeouts",
   "CallbackMayRunLong",
   "CallMsgFilter",
   "CallNamedPipe",
   "CallNextHookEx",
   "CallNtPowerInformation",
   "CallWindowProc",
   "CallWndProc",
   "CallWndRetProc",
   "CancelDC",
   "CancelIo",
   "CancelIoEx",
   "CancelNtmsLibraryRequest",
   "CancelNtmsOperatorRequest",
   "CancelSynchronousIo",
   "CancelThreadpoolIo",
   "CancelWaitableTimer",
   "CanUserWritePwrScheme",
   "CascadeWindows",
   "CBTProc",
   "ChangeClipboardChain",
   "ChangeDisplaySettings",
   "ChangeDisplaySettingsEx",
   "ChangeNtmsMediaType",
   "ChangeServiceConfig",
   "ChangeServiceConfig2",
   "ChangeTimerQueueTimer",
   "ChangeWindowMessageFilter",
   "CharLower",
   "CharLowerBuff",
   "CharNext",
   "CharNextExA",
   "CharPrev",
   "CharPrevExA",
   "CharToOem",
   "CharToOemBuff",
   "CharUpper",
   "CharUpperBuff",
   "CheckDlgButton",
   "CheckMenuItem",
   "CheckMenuRadioItem",
   "CheckNameLegalDOS8Dot3",
   "CheckRadioButton",
   "CheckRemoteDebuggerPresent",
   "ChildWindowFromPoint",
   "ChildWindowFromPointEx",
   "Chord",
   "ClaimMediaLabel",
   "CleanNtmsDrive",
   "ClearCommBreak",
   "ClearCommError",
   "ClearEventLog",
   "ClientToScreen",
   "ClipCursor",
   "CloseClipboard",
   "CloseDesktop",
   "CloseEnhMetaFile",
   "CloseEventLog",
   "CloseFigure",
   "CloseHandle",
   "CloseMetaFile",
   "CloseNtmsNotification",
   "CloseNtmsSession",
   "ClosePrinter",
   "ClosePrivateNamespace",
   "CloseServiceHandle",
   "CloseThreadpool",
   "CloseThreadpoolCleanupGroup",
   "CloseThreadpoolCleanupGroupMembers",
   "CloseThreadpoolIo",
   "CloseThreadpoolTimer",
   "CloseThreadpoolWait",
   "CloseThreadpoolWork",
   "CloseThreadWaitChainSession",
   "CloseTrace",
   "CloseWindow",
   "CloseWindowStation",
   "CombineRgn",
   "CombineTransform",
   "CommandLineToArgvW",
   "CommConfigDialog",
   "CompareFileTime",
   "CompareString",
   "ConfigurePort",
   "ConnectNamedPipe",
   "ConnectToPrinterDlg",
   "ContinueDebugEvent",
   "ControlCallback",
   "ControlService",
   "ControlServiceEx",
   "ControlTrace",
   "ConvertDefaultLocale",
   "ConvertFiberToThread",
   "ConvertThreadToFiber",
   "ConvertThreadToFiberEx",
   "CopyAcceleratorTable",
   "CopyCursor",
   "CopyEnhMetaFile",
   "CopyFile",
   "CopyFileEx",
   "CopyIcon",
   "CopyImage",
   "CopyMemory",
   "CopyMetaFile",
   "CopyProgressRoutine",
   "CopyRect",
   "CountClipboardFormats",
   "CounterPathCallBack",
   "CoTaskMemAlloc",
   "CoTaskMemFree",
   "CreateAcceleratorTable",
   "CreateBitmap",
   "CreateBitmapIndirect",
   "CreateBoundaryDescriptor",
   "CreateBrushIndirect",
   "CreateCaret",
   "CreateCompatibleBitmap",
   "CreateCompatibleDC",
   "CreateConsoleScreenBuffer",
   "CreateCursor",
   "CreateDC",
   "CreateDesktop",
   "CreateDesktopEx",
   "CreateDIBitmap",
   "CreateDIBPatternBrush",
   "CreateDIBPatternBrushPt",
   "CreateDIBSection",
   "CreateDialog",
   "CreateDialogIndirect",
   "CreateDialogIndirectParam",
   "CreateDialogParam",
   "CreateDirectory",
   "CreateDirectoryEx",
   "CreateDiscardableBitmap",
   "CreateEllipticRgn",
   "CreateEllipticRgnIndirect",
   "CreateEnhMetaFile",
   "CreateEvent",
   "CreateEventEx",
   "CreateFiber",
   "CreateFiberEx",
   "CreateFile",
   "CreateFileMapping",
   "CreateFileMappingNuma",
   "CreateFont",
   "CreateFontIndirect",
   "CreateFontIndirectEx",
   "CreateHalftonePalette",
   "CreateHardLink",
   "CreateHatchBrush",
   "CreateIC",
   "CreateIcon",
   "CreateIconFromResource",
   "CreateIconFromResourceEx",
   "CreateIconIndirect",
   "CreateIoCompletionPort",
   "CreateJobObject",
   "CreateMailslot",
   "CreateMDIWindow",
   "CreateMenu",
   "CreateMetaFile",
   "CreateMutex",
   "CreateMutexEx",
   "CreateNamedPipe",
   "CreateNtmsMedia",
   "CreateNtmsMediaPool",
   "CreatePalette",
   "CreatePatternBrush",
   "CreatePen",
   "CreatePenIndirect",
   "CreatePipe",
   "CreatePolygonRgn",
   "CreatePolyPolygonRgn",
   "CreatePopupMenu",
   "CreatePrivateNamespace",
   "CreateProcess",
   "CreateProcessAsUser",
   "CreateProcessWithLogonW",
   "CreateProcessWithTokenW",
   "CreateRectRgn",
   "CreateRectRgnIndirect",
   "CreateRemoteThread",
   "CreateRoundRectRgn",
   "CreateScalableFontResource",
   "CreateSemaphore",
   "CreateSemaphoreEx",
   "CreateService",
   "CreateSolidBrush",
   "CreateSymbolicLink",
   "CreateTapePartition",
   "CreateThread",
   "CreateThreadpool",
   "CreateThreadpoolCleanupGroup",
   "CreateThreadpoolIo",
   "CreateThreadpoolTimer",
   "CreateThreadpoolWait",
   "CreateThreadpoolWork",
   "CreateTimerQueue",
   "CreateTimerQueueTimer",
   "CreateToolhelp32Snapshot",
   "CreateTraceInstanceId",
   "CreateWaitableTimer",
   "CreateWaitableTimerEx",
   "CreateWindow",
   "CreateWindowEx",
   "CreateWindowStation",
   "DdeAbandonTransaction",
   "DdeAccessData",
   "DdeAddData",
   "DdeCallback",
   "DdeClientTransaction",
   "DdeCmpStringHandles",
   "DdeConnect",
   "DdeConnectList",
   "DdeCreateDataHandle",
   "DdeCreateStringHandle",
   "DdeDisconnect",
   "DdeDisconnectList",
   "DdeEnableCallback",
   "DdeFreeDataHandle",
   "DdeFreeStringHandle",
   "DdeGetData",
   "DdeGetLastError",
   "DdeImpersonateClient",
   "DdeInitialize",
   "DdeKeepStringHandle",
   "DdeNameService",
   "DdePostAdvise",
   "DdeQueryConvInfo",
   "DdeQueryNextServer",
   "DdeQueryString",
   "DdeReconnect",
   "DdeSetQualityOfService",
   "DdeSetUserHandle",
   "DdeUnaccessData",
   "DdeUninitialize",
   "DeallocateNtmsMedia",
   "DebugActiveProcess",
   "DebugActiveProcessStop",
   "DebugBreak",
   "DebugBreakProcess",
   "DebugProc",
   "DebugSetProcessKillOnExit",
   "DecommissionNtmsMedia",
   "DecryptFile",
   "DeferWindowPos",
   "DefFrameProc",
   "DefineDosDevice",
   "DefMDIChildProc",
   "DefRawInputProc",
   "DefWindowProc",
   "DeleteAtom",
   "DeleteBoundaryDescriptor",
   "DeleteCriticalSection",
   "DeleteDC",
   "DeleteEnhMetaFile",
   "DeleteFiber",
   "DeleteFile",
   "DeleteForm",
   "DeleteMenu",
   "DeleteMetaFile",
   "DeleteMonitor",
   "DeleteNtmsDrive",
   "DeleteNtmsLibrary",
   "DeleteNtmsMedia",
   "DeleteNtmsMediaPool",
   "DeleteNtmsMediaType",
   "DeleteNtmsRequests",
   "DeleteObject",
   "DeletePort",
   "DeletePrinter",
   "DeletePrinterConnection",
   "DeletePrinterData",
   "DeletePrinterDataEx",
   "DeletePrinterDriver",
   "DeletePrinterDriverEx",
   "DeletePrinterKey",
   "DeletePrintProcessor",
   "DeletePrintProvidor",
   "DeleteProcThreadAttributeList",
   "DeletePwrScheme",
   "DeleteService",
   "DeleteTimerQueue",
   "DeleteTimerQueueEx",
   "DeleteTimerQueueTimer",
   "DeleteVolumeMountPoint",
   "DeregisterEventSource",
   "DeregisterShellHookWindow",
   "DestroyAcceleratorTable",
   "DestroyCaret",
   "DestroyCursor",
   "DestroyIcon",
   "DestroyMenu",
   "DestroyThreadpoolEnvironment",
   "DestroyWindow",
   "DeviceCapabilities",
   "DeviceIoControl",
   "DisableNtmsObject",
   "DisableProcessWindowsGhosting",
   "DisableThreadLibraryCalls",
   "DisassociateCurrentThreadFromCallback",
   "DisconnectNamedPipe",
   "DismountNtmsDrive",
   "DismountNtmsMedia",
   "DispatchMessage",
   "DlgDirList",
   "DlgDirListComboBox",
   "DlgDirSelectComboBoxEx",
   "DlgDirSelectEx",
   "DllMain",
   "DnsHostnameToComputerName",
   "DocumentProperties",
   "DosDateTimeToFileTime",
   "DPtoLP",
   "DragDetect",
   "DrawAnimatedRects",
   "DrawCaption",
   "DrawEdge",
   "DrawEscape",
   "DrawFocusRect",
   "DrawFrameControl",
   "DrawIcon",
   "DrawIconEx",
   "DrawMenuBar",
   "DrawState",
   "DrawStateProc",
   "DrawText",
   "DrawTextEx",
   "DuplicateEncryptionInfoFile",
   "DuplicateIcon",
   "EditWordBreakProc",
   "EjectDiskFromSADrive",
   "EjectNtmsCleaner",
   "EjectNtmsMedia",
   "Ellipse",
   "EmptyClipboard",
   "EmptyWorkingSet",
   "EnableMenuItem",
   "EnableNtmsObject",
   "EnableScrollBar",
   "EnableTrace",
   "EnableWindow",
   "EncryptFile",
   "EncryptionDisable",
   "EndDeferWindowPos",
   "EndDoc",
   "EndDocPrinter",
   "EndMenu",
   "EndNtmsDeviceChangeDetection",
   "EndPage",
   "EndPagePrinter",
   "EndPaint",
   "EndPath",
   "EndTask",
   "EndUpdateResource",
   "EnhMetaFileProc",
   "EnterCriticalSection",
   "EnumCalendarInfo",
   "EnumCalendarInfoEx",
   "EnumCalendarInfoProc",
   "EnumCalendarInfoProcEx",
   "EnumChildProc",
   "EnumChildWindows",
   "EnumClipboardFormats",
   "EnumCodePagesProc",
   "EnumDateFormats",
   "EnumDateFormatsEx",
   "EnumDateFormatsProc",
   "EnumDateFormatsProcEx",
   "EnumDependentServices",
   "EnumDesktopProc",
   "EnumDesktops",
   "EnumDesktopWindows",
   "EnumDeviceDrivers",
   "EnumDisplayDevices",
   "EnumDisplayMonitors",
   "EnumDisplaySettings",
   "EnumDisplaySettingsEx",
   "EnumEnhMetaFile",
   "EnumerateNtmsObject",
   "EnumerateTraceGuids",
   "EnumFontFamExProc",
   "EnumFontFamilies",
   "EnumFontFamiliesEx",
   "EnumFontFamProc",
   "EnumFonts",
   "EnumFontsProc",
   "EnumForms",
   "EnumGeoInfoProc",
   "EnumInputContext",
   "EnumJobs",
   "EnumLanguageGroupLocales",
   "EnumLanguageGroupLocalesProc",
   "EnumLanguageGroupsProc",
   "EnumLocalesProc",
   "EnumMetaFile",
   "EnumMetaFileProc",
   "EnumMonitors",
   "EnumObjects",
   "EnumObjectsProc",
   "EnumPageFiles",
   "EnumPorts",
   "EnumPrinterData",
   "EnumPrinterDataEx",
   "EnumPrinterDrivers",
   "EnumPrinterKey",
   "EnumPrinters",
   "EnumPrintProcessorDatatypes",
   "EnumPrintProcessors",
   "EnumProcesses",
   "EnumProcessModules",
   "EnumProcessModulesEx",
   "EnumProps",
   "EnumPropsEx",
   "EnumPwrSchemes",
   "EnumRegisterWordProc",
   "EnumResLangProc",
   "EnumResNameProc",
   "EnumResourceLanguages",
   "EnumResourceNames",
   "EnumResourceTypes",
   "EnumResTypeProc",
   "EnumServicesStatus",
   "EnumServicesStatusEx",
   "EnumSystemCodePages",
   "EnumSystemFirmwareTables",
   "EnumSystemGeoID",
   "EnumSystemLanguageGroups",
   "EnumSystemLocales",
   "EnumThreadWindows",
   "EnumThreadWndProc",
   "EnumTimeFormats",
   "EnumTimeFormatsProc",
   "EnumUILanguages",
   "EnumUILanguagesProc",
   "EnumWindows",
   "EnumWindowsProc",
   "EnumWindowStationProc",
   "EnumWindowStations",
   "EqualRect",
   "EqualRgn",
   "EraseTape",
   "Escape",
   "EscapeCommFunction",
   "EventCallback",
   "EventClassCallback",
   "ExcludeClipRect",
   "ExcludeUpdateRgn",
   "ExitProcess",
   "ExitThread",
   "ExitWindows",
   "ExitWindowsEx",
   "ExpandEnvironmentStrings",
   "ExportNtmsDatabase",
   "ExtCreatePen",
   "ExtCreateRegion",
   "ExtEscape",
   "ExtFloodFill",
   "ExtractAssociatedIcon",
   "ExtractIcon",
   "ExtractIconEx",
   "ExtSelectClipRgn",
   "ExtTextOut",
   "FatalAppExit",
   "FatalExit",
   "FiberProc",
   "FileEncryptionStatus",
   "FileIOCompletionRoutine",
   "FileTimeToDosDateTime",
   "FileTimeToLocalFileTime",
   "FileTimeToSystemTime",
   "FillConsoleOutputAttribute",
   "FillConsoleOutputCharacter",
   "FillMemory",
   "FillPath",
   "FillRect",
   "FillRgn",
   "FindAtom",
   "FindClose",
   "FindCloseChangeNotification",
   "FindClosePrinterChangeNotification",
   "FindFirstChangeNotification",
   "FindFirstFile",
   "FindFirstFileEx",
   "FindFirstFileNameW",
   "FindFirstPrinterChangeNotification",
   "FindFirstStreamW",
   "FindFirstVolume",
   "FindFirstVolumeMountPoint",
   "FindNextChangeNotification",
   "FindNextFile",
   "FindNextFileNameW",
   "FindNextPrinterChangeNotification",
   "FindNextStreamW",
   "FindNextVolume",
   "FindNextVolumeMountPoint",
   "FindResource",
   "FindResourceEx",
   "FindVolumeClose",
   "FindVolumeMountPointClose",
   "FindWindow",
   "FindWindowEx",
   "FlashWindow",
   "FlashWindowEx",
   "FlattenPath",
   "FloodFill",
   "FlsAlloc",
   "FlsCallback",
   "FlsFree",
   "FlsGetValue",
   "FlsSetValue",
   "FlushConsoleInputBuffer",
   "FlushFileBuffers",
   "FlushInstructionCache",
   "FlushPrinter",
   "FlushTrace",
   "FlushViewOfFile",
   "FoldString",
   "ForegroundIdleProc",
   "FormatMessage",
   "FrameRect",
   "FrameRgn",
   "FreeConsole",
   "FreeDDElParam",
   "FreeEncryptionCertificateHashList",
   "FreeEnvironmentStrings",
   "FreeLibrary",
   "FreeLibraryAndExitThread",
   "FreeLibraryWhenCallbackReturns",
   "FreePrinterNotifyInfo",
   "FreeUserPhysicalPages",
   "GdiComment",
   "GdiFlush",
   "GdiGetBatchLimit",
   "GdiSetBatchLimit",
   "GenerateConsoleCtrlEvent",
   "GetACP",
   "GetActivePwrScheme",
   "GetActiveWindow",
   "GetAltTabInfo",
   "GetAncestor",
   "GetApplicationRecoveryCallback",
   "GetApplicationRestartSettings",
   "GetArcDirection",
   "GetAspectRatioFilterEx",
   "GetAsyncKeyState",
   "GetAtomName",
   "GetBinaryType",
   "GetBitmapBits",
   "GetBitmapDimensionEx",
   "GetBkColor",
   "GetBkMode",
   "GetBoundsRect",
   "GetBrushOrgEx",
   "GetCalendarInfo",
   "GetCapture",
   "GetCaretBlinkTime",
   "GetCaretPos",
   "GetCharABCWidths",
   "GetCharABCWidthsFloat",
   "GetCharABCWidthsI",
   "GetCharacterPlacement",
   "GetCharWidth",
   "GetCharWidth32",
   "GetCharWidthFloat",
   "GetCharWidthI",
   "GetClassInfo",
   "GetClassInfoEx",
   "GetClassLong",
   "GetClassLongPtr",
   "GetClassName",
   "GetClassWord",
   "GetClientRect",
   "GetClipboardData",
   "GetClipboardFormatName",
   "GetClipboardOwner",
   "GetClipboardSequenceNumber",
   "GetClipboardViewer",
   "GetClipBox",
   "GetClipCursor",
   "GetClipRgn",
   "GetColorAdjustment",
   "GetComboBoxInfo",
   "GetCommandLine",
   "GetCommConfig",
   "GetCommMask",
   "GetCommModemStatus",
   "GetCommProperties",
   "GetCommState",
   "GetCommTimeouts",
   "GetCompressedFileSize",
   "GetComputerName",
   "GetComputerNameEx",
   "GetComputerObjectName",
   "GetConsoleCP",
   "GetConsoleCursorInfo",
   "GetConsoleDisplayMode",
   "GetConsoleFontSize",
   "GetConsoleHistoryInfo",
   "GetConsoleMode",
   "GetConsoleOriginalTitle",
   "GetConsoleOutputCP",
   "GetConsoleProcessList",
   "GetConsoleScreenBufferInfo",
   "GetConsoleScreenBufferInfoEx",
   "GetConsoleSelectionInfo",
   "GetConsoleTitle",
   "GetConsoleWindow",
   "GetCPInfo",
   "GetCPInfoEx",
   "GetCurrencyFormat",
   "GetCurrentConsoleFont",
   "GetCurrentConsoleFontEx",
   "GetCurrentDirectory",
   "GetCurrentHwProfile",
   "GetCurrentObject",
   "GetCurrentPositionEx",
   "GetCurrentPowerPolicies",
   "GetCurrentProcess",
   "GetCurrentProcessId",
   "GetCurrentProcessorNumber",
   "GetCurrentThread",
   "GetCurrentThreadId",
   "GetCursor",
   "GetCursorInfo",
   "GetCursorPos",
   "GetDateFormat",
   "GetDC",
   "GetDCBrushColor",
   "GetDCEx",
   "GetDCOrgEx",
   "GetDCPenColor",
   "GetDefaultCommConfig",
   "GetDefaultPrinter",
   "GetDesktopWindow",
   "GetDeviceCaps",
   "GetDeviceDriverBaseName",
   "GetDeviceDriverFileName",
   "GetDevicePowerState",
   "GetDIBColorTable",
   "GetDIBits",
   "GetDiskFreeSpace",
   "GetDiskFreeSpaceEx",
   "GetDllDirectory",
   "GetDoubleClickTime",
   "GetDriveType",
   "GetDynamicTimeZoneInformation",
   "GetEnhMetaFile",
   "GetEnhMetaFileBits",
   "GetEnhMetaFileDescription",
   "GetEnhMetaFileHeader",
   "GetEnhMetaFilePaletteEntries",
   "GetEnvironmentStrings",
   "GetEnvironmentVariable",
   "GetErrorMode",
   "GetEventLogInformation",
   "GetExceptionCode",
   "GetExceptionInformation",
   "GetExitCodeProcess",
   "GetExitCodeThread",
   "GetExpandedName",
   "GetFileAttributes",
   "GetFileAttributesEx",
   "GetFileBandwidthReservation",
   "GetFileInformationByHandle",
   "GetFileInformationByHandleEx",
   "GetFileSize",
   "GetFileSizeEx",
   "GetFileTime",
   "GetFileType",
   "GetFileVersionInfo",
   "GetFileVersionInfoSize",
   "GetFinalPathNameByHandle",
   "GetFocus",
   "GetFontData",
   "GetFontLanguageInfo",
   "GetFontUnicodeRanges",
   "GetForegroundWindow",
   "GetForm",
   "GetFullPathName",
   "GetGeoInfo",
   "GetGlyphIndices",
   "GetGlyphOutline",
   "GetGraphicsMode",
   "GetGuiResources",
   "GetGUIThreadInfo",
   "GetIconInfo",
   "GetInputState",
   "GetJob",
   "GetKBCodePage",
   "GetKerningPairs",
   "GetKeyboardLayout",
   "GetKeyboardLayoutList",
   "GetKeyboardLayoutName",
   "GetKeyboardState",
   "GetKeyboardType",
   "GetKeyNameText",
   "GetKeyState",
   "GetLargePageMinimum",
   "GetLargestConsoleWindowSize",
   "GetLastActivePopup",
   "GetLastError",
   "GetLastInputInfo",
   "GetLayeredWindowAttributes",
   "GetLayout",
   "GetListBoxInfo",
   "GetLocaleInfo",
   "GetLocaleInfoEx",
   "GetLocalTime",
   "GetLogicalDrives",
   "GetLogicalDriveStrings",
   "GetLogicalProcessorInformation",
   "GetLongPathName",
   "GetMailslotInfo",
   "GetMapMode",
   "GetMappedFileName",
   "GetMenu",
   "GetMenuBarInfo",
   "GetMenuCheckMarkDimensions",
   "GetMenuDefaultItem",
   "GetMenuInfo",
   "GetMenuItemCount",
   "GetMenuItemID",
   "GetMenuItemInfo",
   "GetMenuItemRect",
   "GetMenuState",
   "GetMenuString",
   "GetMessage",
   "GetMessageExtraInfo",
   "GetMessagePos",
   "GetMessageTime",
   "GetMetaFileBitsEx",
   "GetMetaRgn",
   "GetMiterLimit",
   "GetModuleBaseName",
   "GetModuleFileName",
   "GetModuleFileNameEx",
   "GetModuleHandle",
   "GetModuleHandleEx",
   "GetModuleInformation",
   "GetMonitorInfo",
   "GetMouseMovePointsEx",
   "GetMsgProc",
   "GetNamedPipeClientComputerName",
   "GetNamedPipeClientProcessId",
   "GetNamedPipeClientSessionId",
   "GetNamedPipeHandleState",
   "GetNamedPipeInfo",
   "GetNamedPipeServerProcessId",
   "GetNamedPipeServerSessionId",
   "GetNativeSystemInfo",
   "GetNearestColor",
   "GetNearestPaletteIndex",
   "GetNextWindow",
   "GetNtmsMediaPoolName",
   "GetNtmsObjectAttribute",
   "GetNtmsObjectInformation",
   "GetNtmsObjectSecurity",
   "GetNtmsRequestOrder",
   "GetNtmsUIOptions",
   "GetNumaAvailableMemoryNode",
   "GetNumaHighestNodeNumber",
   "GetNumaNodeProcessorMask",
   "GetNumaProcessorNode",
   "GetNumaProximityNode",
   "GetNumberFormat",
   "GetNumberFormatEx",
   "GetNumberOfConsoleInputEvents",
   "GetNumberOfConsoleMouseButtons",
   "GetNumberOfEventLogRecords",
   "GetObject",
   "GetObjectType",
   "GetOEMCP",
   "GetOldestEventLogRecord",
   "GetOpenClipboardWindow",
   "GetOutlineTextMetrics",
   "GetOverlappedResult",
   "GetPaletteEntries",
   "GetParent",
   "GetPath",
   "GetPerformanceInfo",
   "GetPixel",
   "GetPolyFillMode",
   "GetPrinter",
   "GetPrinterData",
   "GetPrinterDataEx",
   "GetPrinterDriver",
   "GetPrinterDriverDirectory",
   "GetPrintProcessorDirectory",
   "GetPriorityClass",
   "GetPriorityClipboardFormat",
   "GetPrivateProfileInt",
   "GetPrivateProfileSection",
   "GetPrivateProfileSectionNames",
   "GetPrivateProfileString",
   "GetPrivateProfileStruct",
   "GetProcAddress",
   "GetProcessAffinityMask",
   "GetProcessDefaultLayout",
   "GetProcessHandleCount",
   "GetProcessHeap",
   "GetProcessHeaps",
   "GetProcessId",
   "GetProcessIdOfThread",
   "GetProcessIoCounters",
   "GetProcessMemoryInfo",
   "GetProcessPriorityBoost",
   "GetProcessShutdownParameters",
   "GetProcessTimes",
   "GetProcessVersion",
   "GetProcessWindowStation",
   "GetProcessWorkingSetSize",
   "GetProcessWorkingSetSizeEx",
   "GetProductInfo",
   "GetProfileInt",
   "GetProfileSection",
   "GetProfileString",
   "GetProp",
   "GetPwrCapabilities",
   "GetPwrDiskSpindownRange",
   "GetQueuedCompletionStatus",
   "GetQueuedCompletionStatusEx",
   "GetQueueStatus",
   "GetRandomRgn",
   "GetRasterizerCaps",
   "GetRawInputBuffer",
   "GetRawInputData",
   "GetRawInputDeviceInfo",
   "GetRawInputDeviceList",
   "GetRegionData",
   "GetRegisteredRawInputDevices",
   "GetRgnBox",
   "GetROP2",
   "GetScrollBarInfo",
   "GetScrollInfo",
   "GetScrollPos",
   "GetScrollRange",
   "GetServiceDisplayName",
   "GetServiceKeyName",
   "GetShellWindow",
   "GetShortPathName",
   "GetStartupInfo",
   "GetStdHandle",
   "GetStockObject",
   "GetStretchBltMode",
   "GetStringTypeA",
   "GetStringTypeEx",
   "GetStringTypeW",
   "GetSubMenu",
   "GetSysColor",
   "GetSysColorBrush",
   "GetSystemDefaultLangID",
   "GetSystemDefaultLCID",
   "GetSystemDefaultUILanguage",
   "GetSystemDirectory",
   "GetSystemFileCacheSize",
   "GetSystemFirmwareTable",
   "GetSystemInfo",
   "GetSystemMenu",
   "GetSystemMetrics",
   "GetSystemPaletteEntries",
   "GetSystemPaletteUse",
   "GetSystemPowerStatus",
   "GetSystemRegistryQuota",
   "GetSystemTime",
   "GetSystemTimes",
   "GetSystemTimeAdjustment",
   "GetSystemTimeAsFileTime",
   "GetSystemWindowsDirectory",
   "GetSystemWow64Directory",
   "GetTabbedTextExtent",
   "GetTapeParameters",
   "GetTapePosition",
   "GetTapeStatus",
   "GetTempFileName",
   "GetTempPath",
   "GetTextAlign",
   "GetTextCharacterExtra",
   "GetTextColor",
   "GetTextExtentExPoint",
   "GetTextExtentExPointI",
   "GetTextExtentPoint",
   "GetTextExtentPoint32",
   "GetTextExtentPointI",
   "GetTextFace",
   "GetTextMetrics",
   "GetThreadContext",
   "GetThreadDesktop",
   "GetThreadId",
   "GetThreadIOPendingFlag",
   "GetThreadLocale",
   "GetThreadPreferredUILanguages",
   "GetThreadPriority",
   "GetThreadPriorityBoost",
   "GetThreadSelectorEntry",
   "GetThreadTimes",
   "GetThreadUILanguage",
   "GetThreadWaitChain",
   "GetTickCount",
   "GetTickCount64",
   "GetTimeFormat",
   "GetTimeFormatEx",
   "GetTimeSysInfo",
   "GetTimeZoneInformation",
   "GetTitleBarInfo",
   "GetTopWindow",
   "GetTraceEnableFlags",
   "GetTraceEnableLevel",
   "GetTraceLoggerHandle",
   "GetUpdateRect",
   "GetUpdateRgn",
   "GetUserDefaultLangID",
   "GetUserDefaultLCID",
   "GetUserDefaultUILanguage",
   "GetUserGeoID",
   "GetUserName",
   "GetUserNameEx",
   "GetUserObjectInformation",
   "GetVersion",
   "GetVersionEx",
   "GetViewportExtEx",
   "GetViewportOrgEx",
   "GetVolumeInformation",
   "GetVolumeNameForVolumeMountPoint",
   "GetVolumePathName",
   "GetVolumePathNamesForVolumeName",
   "GetVolumesFromDrive",
   "GetWindow",
   "GetWindowDC",
   "GetWindowExtEx",
   "GetWindowInfo",
   "GetWindowLong",
   "GetWindowLongPtr",
   "GetWindowModuleFileName",
   "GetWindowOrgEx",
   "GetWindowPlacement",
   "GetWindowRect",
   "GetWindowRgn",
   "GetWindowRgnBox",
   "GetWindowsDirectory",
   "GetWindowText",
   "GetWindowTextLength",
   "GetWindowThreadProcessId",
   "GetWinMetaFileBits",
   "GetWorldTransform",
   "GetWriteWatch",
   "GetWsChanges",
   "GlobalAddAtom",
   "GlobalAlloc",
   "GlobalDeleteAtom",
   "GlobalDiscard",
   "GlobalFindAtom",
   "GlobalFlags",
   "GlobalFree",
   "GlobalGetAtomName",
   "GlobalHandle",
   "GlobalLock",
   "GlobalMemoryStatus",
   "GlobalMemoryStatusEx",
   "GlobalReAlloc",
   "GlobalSize",
   "GlobalUnlock",
   "GradientFill",
   "GrayString",
   "Handler",
   "HandlerEx",
   "HandlerRoutine",
   "Heap32First",
   "Heap32ListFirst",
   "Heap32ListNext",
   "Heap32Next",
   "HeapAlloc",
   "HeapCompact",
   "HeapCreate",
   "HeapDestroy",
   "HeapFree",
   "HeapLock",
   "HeapQueryInformation",
   "HeapReAlloc",
   "HeapSetInformation",
   "HeapSize",
   "HeapUnlock",
   "HeapValidate",
   "HeapWalk",
   "HideCaret",
   "HiliteMenuItem",
   "IdentifyNtmsSlot",
   "ImpersonateDdeClientWindow",
   "ImportNtmsDatabase",
   "InflateRect",
   "InitAtomTable",
   "InitializeConditionVariable",
   "InitializeCriticalSection",
   "InitializeCriticalSectionEx",
   "InitializeCriticalSectionAndSpinCount",
   "InitializeProcessForWsWatch",
   "InitializeProcThreadAttributeList",
   "InitializeSRWLock",
   "InitializeThreadpoolEnvironment",
   "InitiateShutdown",
   "InitiateSystemShutdown",
   "InitiateSystemShutdownEx",
   "InitOnceBeginInitialize",
   "InitOnceComplete",
   "InitOnceExecuteOnce",
   "InitOnceInitialize",
   "InjectNtmsCleaner",
   "InjectNtmsMedia",
   "InSendMessage",
   "InSendMessageEx",
   "InsertMenu",
   "InsertMenuItem",
   "InterlockedCompareExchange",
   "InterlockedCompareExchangeAcquire",
   "InterlockedCompareExchangeAcquire64",
   "InterlockedCompareExchangePointer",
   "InterlockedCompareExchangeRelease",
   "InterlockedCompareExchangeRelease64",
   "InterlockedDecrement",
   "InterlockedDecrement64",
   "InterlockedDecrementAcquire",
   "InterlockedDecrementRelease",
   "InterlockedExchange",
   "InterlockedExchangeAcquire64",
   "InterlockedExchangeAdd",
   "InterlockedExchangePointer",
   "InterlockedIncrement",
   "InterlockedIncrement64",
   "InterlockedIncrementAcquire",
   "InterlockedIncrementRelease",
   "InternalGetWindowText",
   "IntersectClipRect",
   "IntersectRect",
   "InvalidateRect",
   "InvalidateRgn",
   "InventoryNtmsLibrary",
   "InvertRect",
   "InvertRgn",
   "IsBadCodePtr",
   "IsBadReadPtr",
   "IsBadStringPtr",
   "IsBadWritePtr",
   "IsCharAlpha",
   "IsCharAlphaNumeric",
   "IsCharLower",
   "IsCharUpper",
   "IsChild",
   "IsClipboardFormatAvailable",
   "IsDebuggerPresent",
   "IsDlgButtonChecked",
   "IsGUIThread",
   "IsHungAppWindow",
   "IsIconic",
   "IsMenu",
   "IsProcessInJob",
   "IsProcessorFeaturePresent",
   "IsPwrHibernateAllowed",
   "IsPwrShutdownAllowed",
   "IsPwrSuspendAllowed",
   "IsRectEmpty",
   "IsSystemResumeAutomatic",
   "IsThreadAFiber",
   "IsThreadpoolTimerSet",
   "IsValidCodePage",
   "IsValidLanguageGroup",
   "IsValidLocale",
   "IsValidLocaleName",
   "IsWindow",
   "IsWindowEnabled",
   "IsWindowUnicode",
   "IsWindowVisible",
   "IsWow64Message",
   "IsWow64Process",
   "IsZoomed",
   "JournalPlaybackProc",
   "JournalRecordProc",
   "keybd_event",
   "KeyboardProc",
   "KillTimer",
   "LCMapString",
   "LeaveCriticalSection",
   "LeaveCriticalSectionWhenCallbackReturns",
   "LineDDA",
   "LineDDAProc",
   "LineTo",
   "LoadAccelerators",
   "LoadBitmap",
   "LoadCursor",
   "LoadCursorFromFile",
   "LoadIcon",
   "LoadImage",
   "LoadKeyboardLayout",
   "LoadLibrary",
   "LoadLibraryEx",
   "LoadLibraryA",
   "LoadMenu",
   "LoadMenuIndirect",
   "LoadModule",
   "LoadPerfCounterTextStrings",
   "LoadResource",
   "LoadString",
   "LocalAlloc",
   "LocalDiscard",
   "LocalFileTimeToFileTime",
   "LocalFlags",
   "LocalFree",
   "LocalHandle",
   "LocalLock",
   "LocalReAlloc",
   "LocalSize",
   "LocalUnlock",
   "LockFile",
   "LockFileEx",
   "LockResource",
   "LockServiceDatabase",
   "LockSetForegroundWindow",
   "LockWindowUpdate",
   "LockWorkStation",
   "LogicalToPhysicalPoint",
   "LogTimeProvEvent",
   "LookupIconIdFromDirectory",
   "LookupIconIdFromDirectoryEx",
   "LowLevelKeyboardProc",
   "LowLevelMouseProc",
   "LPtoDP",
   "lstrcat",
   "lstrcmp",
   "lstrcmpi",
   "lstrcpy",
   "lstrcpyn",
   "lstrlen",
   "LZClose",
   "LZCopy",
   "LZInit",
   "LZOpenFile",
   "LZRead",
   "LZSeek",
   "MapDialogRect",
   "MapUserPhysicalPages",
   "MapUserPhysicalPagesScatter",
   "MapViewOfFile",
   "MapViewOfFileEx",
   "MapViewOfFileExNuma",
   "MapVirtualKey",
   "MapVirtualKeyEx",
   "MapWindowPoints",
   "MaskBlt",
   "MaxMediaLabel",
   "MemoryBarrier",
   "MenuItemFromPoint",
   "MessageBeep",
   "MessageBox",
   "MessageBoxEx",
   "MessageBoxIndirect",
   "MessageProc",
   "ModifyMenu",
   "ModifyWorldTransform",
   "Module32First",
   "Module32Next",
   "MonitorEnumProc",
   "MonitorFromPoint",
   "MonitorFromRect",
   "MonitorFromWindow",
   "MountNtmsMedia",
   "mouse_event",
   "MouseProc",
   "MoveFile",
   "MoveFileEx",
   "MoveFileWithProgress",
   "MoveMemory",
   "MoveToEx",
   "MoveToNtmsMediaPool",
   "MoveWindow",
   "MsgWaitForMultipleObjects",
   "MsgWaitForMultipleObjectsEx",
   "MultinetGetConnectionPerformance",
   "MultiByteToWideChar",
   "NDdeGetErrorString",
   "NDdeGetShareSecurity",
   "NDdeGetTrustedShare",
   "NDdeIsValidAppTopicList",
   "NDdeIsValidShareName",
   "NDdeSetShareSecurity",
   "NDdeSetTrustedShare",
   "NDdeShareAdd",
   "NDdeShareDel",
   "NDdeShareEnum",
   "NDdeShareGetInfo",
   "NDdeShareSetInfo",
   "NDdeTrustedShareEnum",
   "NetAccessAdd",
   "NetAccessCheck",
   "NetAccessDel",
   "NetAccessEnum",
   "NetAccessGetInfo",
   "NetAccessGetUserPerms",
   "NetAccessSetInfo",
   "NetAlertRaise",
   "NetAlertRaiseEx",
   "NetApiBufferAllocate",
   "NetApiBufferFree",
   "NetApiBufferReallocate",
   "NetApiBufferSize",
   "NetAuditClear",
   "NetAuditRead",
   "NetAuditWrite",
   "NetConfigGet",
   "NetConfigGetAll",
   "NetConfigSet",
   "NetConnectionEnum",
   "NetDfsAdd",
   "NetDfsAddFtRoot",
   "NetDfsAddStdRoot",
   "NetDfsAddStdRootForced",
   "NetDfsEnum",
   "NetDfsGetClientInfo",
   "NetDfsGetInfo",
   "NetDfsManagerInitialize",
   "NetDfsRemove",
   "NetDfsRemoveFtRoot",
   "NetDfsRemoveFtRootForced",
   "NetDfsRemoveStdRoot",
   "NetDfsSetClientInfo",
   "NetDfsSetInfo",
   "NetErrorLogClear",
   "NetErrorLogRead",
   "NetErrorLogWrite",
   "NetFileClose",
   "NetFileEnum",
   "NetFileGetInfo",
   "NetGetAnyDCName",
   "NetGetDCName",
   "NetGetDisplayInformationIndex",
   "NetGetJoinableOUs",
   "NetGetJoinInformation",
   "NetGroupAdd",
   "NetGroupAddUser",
   "NetGroupDel",
   "NetGroupDelUser",
   "NetGroupEnum",
   "NetGroupGetInfo",
   "NetGroupGetUsers",
   "NetGroupSetInfo",
   "NetGroupSetUsers",
   "NetJoinDomain",
   "NetLocalGroupAdd",
   "NetLocalGroupAddMember",
   "NetLocalGroupAddMembers",
   "NetLocalGroupDel",
   "NetLocalGroupDelMember",
   "NetLocalGroupDelMembers",
   "NetLocalGroupEnum",
   "NetLocalGroupGetInfo",
   "NetLocalGroupGetMembers",
   "NetLocalGroupSetInfo",
   "NetLocalGroupSetMembers",
   "NetMessageBufferSend",
   "NetMessageNameAdd",
   "NetMessageNameDel",
   "NetMessageNameEnum",
   "NetMessageNameGetInfo",
   "NetQueryDisplayInformation",
   "NetRemoteComputerSupports",
   "NetRemoteTOD",
   "NetRenameMachineInDomain",
   "NetScheduleJobAdd",
   "NetScheduleJobDel",
   "NetScheduleJobEnum",
   "NetScheduleJobGetInfo",
   "NetServerComputerNameAdd",
   "NetServerComputerNameDel",
   "NetServerDiskEnum",
   "NetServerEnum",
   "NetServerGetInfo",
   "NetServerSetInfo",
   "NetServerTransportAdd",
   "NetServerTransportAddEx",
   "NetServerTransportDel",
   "NetServerTransportEnum",
   "NetServiceControl",
   "NetServiceEnum",
   "NetServiceGetInfo",
   "NetServiceInstall",
   "NetSessionDel",
   "NetSessionEnum",
   "NetSessionGetInfo",
   "NetShareAdd",
   "NetShareCheck",
   "NetShareDel",
   "NetShareEnum",
   "NetShareGetInfo",
   "NetShareSetInfo",
   "NetStatisticsGet",
   "NetUnjoinDomain",
   "NetUseAdd",
   "NetUseDel",
   "NetUseEnum",
   "NetUseGetInfo",
   "NetUserAdd",
   "NetUserChangePassword",
   "NetUserDel",
   "NetUserEnum",
   "NetUserGetGroups",
   "NetUserGetInfo",
   "NetUserGetLocalGroups",
   "NetUserModalsGet",
   "NetUserModalsSet",
   "NetUserSetGroups",
   "NetUserSetInfo",
   "NetValidateName",
   "NetWkstaGetInfo",
   "NetWkstaSetInfo",
   "NetWkstaTransportAdd",
   "NetWkstaTransportDel",
   "NetWkstaTransportEnum",
   "NetWkstaUserEnum",
   "NetWkstaUserGetInfo",
   "NetWkstaUserSetInfo",
   "NotifyBootConfigStatus",
   "NotifyChangeEventLog",
   "NotifyServiceStatusChange",
   "NtCreateThread",
   "OemKeyScan",
   "OemToChar",
   "OemToCharBuff",
   "OffsetClipRgn",
   "OffsetRect",
   "OffsetRgn",
   "OffsetViewportOrgEx",
   "OffsetWindowOrgEx",
   "OpenBackupEventLog",
   "OpenClipboard",
   "OpenDesktop",
   "OpenEvent",
   "OpenEventLog",
   "OpenFile",
   "OpenFileById",
   "OpenFileMapping",
   "OpenIcon",
   "OpenInputDesktop",
   "OpenJobObject",
   "OpenMutex",
   "OpenNtmsNotification",
   "OpenNtmsSession",
   "OpenPrinter",
   "OpenPrivateNamespace",
   "OpenProcess",
   "OpenSCManager",
   "OpenSemaphore",
   "OpenService",
   "OpenThread",
   "OpenThreadWaitChainSession",
   "OpenTrace",
   "OpenWaitableTimer",
   "OpenWindowStation",
   "OutputDebugString",
   "PackDDElParam",
   "PaintDesktop",
   "PaintRgn",
   "PatBlt",
   "PathToRegion",
   "PdhAddCounter",
   "PdhAddEnglishCounter",
   "PdhBindInputDataSource",
   "PdhBrowseCounters",
   "PdhBrowseCountersH",
   "PdhCalculateCounterFromRawValue",
   "PdhCloseLog",
   "PdhCloseQuery",
   "PdhCollectQueryData",
   "PdhCollectQueryDataEx",
   "PdhCollectQueryDataWithTime",
   "PdhComputeCounterStatistics",
   "PdhConnectMachine",
   "PdhEnumLogSetNames",
   "PdhEnumMachines",
   "PdhEnumMachinesH",
   "PdhEnumObjectItems",
   "PdhEnumObjectItemsH",
   "PdhEnumObjects",
   "PdhEnumObjectsH",
   "PdhExpandCounterPath",
   "PdhExpandWildCardPath",
   "PdhExpandWildCardPathH",
   "PdhFormatFromRawValue",
   "PdhGetCounterInfo",
   "PdhGetCounterTimeBase",
   "PdhGetDataSourceTimeRange",
   "PdhGetDataSourceTimeRangeH",
   "PdhGetDefaultPerfCounter",
   "PdhGetDefaultPerfCounterH",
   "PdhGetDefaultPerfObject",
   "PdhGetDefaultPerfObjectH",
   "PdhGetDllVersion",
   "PdhGetFormattedCounterArray",
   "PdhGetFormattedCounterValue",
   "PdhGetLogFileSize",
   "PdhGetRawCounterArray",
   "PdhGetRawCounterValue",
   "PdhIsRealTimeQuery",
   "PdhLookupPerfIndexByName",
   "PdhLookupPerfNameByIndex",
   "PdhMakeCounterPath",
   "PdhOpenLog",
   "PdhOpenQuery",
   "PdhOpenQueryH",
   "PdhParseCounterPath",
   "PdhParseInstanceName",
   "PdhReadRawLogRecord",
   "PdhRemoveCounter",
   "PdhSelectDataSource",
   "PdhSetCounterScaleFactor",
   "PdhSetDefaultRealTimeDataSource",
   "PdhSetQueryTimeRange",
   "PdhUpdateLog",
   "PdhUpdateLogFileCatalog",
   "PdhValidatePath",
   "PdhValidatePathEx",
   "PeekConsoleInput",
   "PeekMessage",
   "PeekNamedPipe",
   "PhysicalToLogicalPoint",
   "Pie",
   "PlayEnhMetaFile",
   "PlayEnhMetaFileRecord",
   "PlayMetaFile",
   "PlayMetaFileRecord",
   "PlgBlt",
   "PolyBezier",
   "PolyBezierTo",
   "PolyDraw",
   "Polygon",
   "Polyline",
   "PolylineTo",
   "PolyPolygon",
   "PolyPolyline",
   "PolyTextOut",
   "PostMessage",
   "PostQueuedCompletionStatus",
   "PostQuitMessage",
   "PostThreadMessage",
   "PreFetchCacheLine",
   "PrepareTape",
   "PrintDlg",
   "PrintDlgEx",
   "PrinterProperties",
   "PrintWindow",
   "PrivateExtractIcons",
   "Process32First",
   "Process32Next",
   "ProcessTrace",
   "PropEnumProc",
   "PropEnumProcEx",
   "PtInRect",
   "PtInRegion",
   "PtVisible",
   "PulseEvent",
   "PurgeComm",
   "QueryAllTraces",
   "QueryDepthSList",
   "QueryDosDevice",
   "QueryFullProcessImageName",
   "QueryIdleProcessorCycleTime",
   "QueryInformationJobObject",
   "QueryPerformanceCounter",
   "QueryPerformanceFrequency",
   "QueryProcessCycleTime",
   "QueryRecoveryAgentsOnEncryptedFile",
   "QueryServiceConfig",
   "QueryServiceConfig2",
   "QueryServiceLockStatus",
   "QueryServiceStatus",
   "QueryServiceStatusEx",
   "QueryThreadCycleTime",
   "QueryTrace",
   "QueryUsersOnEncryptedFile",
   "QueryWorkingSet",
   "QueryWorkingSetEx",
   "QueueUserAPC",
   "QueueUserWorkItem",
   "RtlCreateUserThread",
   "RaiseException",
   "ReadConsole",
   "ReadConsoleInput",
   "ReadConsoleOutput",
   "ReadConsoleOutputAttribute",
   "ReadConsoleOutputCharacter",
   "ReadDirectoryChangesW",
   "ReadEventLog",
   "ReadFile",
   "ReadFileEx",
   "ReadFileScatter",
   "ReadGlobalPwrPolicy",
   "ReadPrinter",
   "ReadProcessMemory",
   "ReadProcessorPwrScheme",
   "ReadPwrScheme",
   "RealChildWindowFromPoint",
   "RealGetWindowClass",
   "RealizePalette",
   "Rectangle",
   "RectInRegion",
   "RectVisible",
   "RedrawWindow",
   "RegCloseKey",
   "RegConnectRegistry",
   "RegCopyTree",
   "RegCreateKey",
   "RegCreateKeyEx",
   "RegCreateKeyTransacted",
   "RegDeleteKey",
   "RegDeleteKeyEx",
   "RegDeleteKeyTransacted",
   "RegDeleteKeyValue",
   "RegDeleteTree",
   "RegDeleteValue",
   "RegDisablePredefinedCache",
   "RegDisablePredefinedCacheEx",
   "RegDisableReflectionKey",
   "RegEnableReflectionKey",
   "RegEnumKey",
   "RegEnumKeyEx",
   "RegEnumValue",
   "RegFlushKey",
   "RegGetValue",
   "RegisterApplicationRecoveryCallback",
   "RegisterApplicationRestart",
   "RegisterClass",
   "RegisterClassEx",
   "RegisterClipboardFormat",
   "RegisterDeviceNotification",
   "RegisterEventSource",
   "RegisterHotKey",
   "RegisterPowerSettingNotification",
   "RegisterRawInputDevices",
   "RegisterServiceCtrlHandler",
   "RegisterServiceCtrlHandlerEx",
   "RegisterShellHookWindow",
   "RegisterTraceGuids",
   "RegisterWaitChainCOMCallback",
   "RegisterWaitForSingleObject",
   "RegisterWindowMessage",
   "RegLoadAppKey",
   "RegLoadKey",
   "RegLoadMUIString",
   "RegNotifyChangeKeyValue",
   "RegOpenCurrentUser",
   "RegOpenKey",
   "RegOpenKeyEx",
   "RegOpenKeyTransacted",
   "RegOpenUserClassesRoot",
   "RegOverridePredefKey",
   "RegQueryInfoKey",
   "RegQueryMultipleValues",
   "RegQueryReflectionKey",
   "RegQueryValue",
   "RegQueryValueEx",
   "RegReplaceKey",
   "RegRestoreKey",
   "RegSaveKey",
   "RegSaveKeyEx",
   "RegSetKeyValue",
   "RegSetValue",
   "RegSetValueEx",
   "RegUnLoadKey",
   "ReleaseCapture",
   "ReleaseDC",
   "ReleaseMutex",
   "ReleaseMutexWhenCallbackReturns",
   "ReleaseNtmsCleanerSlot",
   "ReleaseSemaphore",
   "ReleaseSemaphoreWhenCallbackReturns",
   "ReleaseSRWLockExclusive",
   "ReleaseSRWLockShared",
   "RemoveDirectory",
   "RemoveFontMemResourceEx",
   "RemoveFontResource",
   "RemoveFontResourceEx",
   "RemoveMenu",
   "RemoveProp",
   "RemoveTraceCallback",
   "RemoveUsersFromEncryptedFile",
   "RemoveVectoredExceptionHandler",
   "ReOpenFile",
   "ReplaceFile",
   "ReplyMessage",
   "ReportEvent",
   "ReportFault",
   "RequestWakeupLatency",
   "ReserveNtmsCleanerSlot",
   "ResetDC",
   "ResetEvent",
   "ResetPrinter",
   "ResetWriteWatch",
   "ResizePalette",
   "RestoreDC",
   "ResumeThread",
   "ReuseDDElParam",
   "RmAddFilter",
   "RmCancelCurrentTask",
   "RmEndSession",
   "RmGetFilterList",
   "RmGetList",
   "RmJoinSession",
   "RmRegisterResources",
   "RmRemoveFilter",
   "RmRestart",
   "RmShutdown",
   "RmStartSession",
   "RoundRect",
   "SatisfyNtmsOperatorRequest",
   "SaveDC",
   "ScaleViewportExtEx",
   "ScaleWindowExtEx",
   "ScheduleJob",
   "ScreenToClient",
   "ScrollConsoleScreenBuffer",
   "ScrollDC",
   "ScrollWindow",
   "ScrollWindowEx",
   "SearchPath",
   "SecureZeroMemory",
   "SelectClipPath",
   "SelectClipRgn",
   "SelectObject",
   "SelectPalette",
   "SendAsyncProc",
   "SendDlgItemMessage",
   "SendInput",
   "SendMessage",
   "SendMessageCallback",
   "SendMessageTimeout",
   "SendNotifyMessage",
   "ServiceMain",
   "SetAbortProc",
   "SetActivePwrScheme",
   "SetActiveWindow",
   "SetArcDirection",
   "SetBitmapBits",
   "SetBitmapDimensionEx",
   "SetBkColor",
   "SetBkMode",
   "SetBoundsRect",
   "SetBrushOrgEx",
   "SetCalendarInfo",
   "SetCapture",
   "SetCaretBlinkTime",
   "SetCaretPos",
   "SetClassLong",
   "SetClassLongPtr",
   "SetClassWord",
   "SetClipboardData",
   "SetClipboardViewer",
   "SetColorAdjustment",
   "SetCommBreak",
   "SetCommConfig",
   "SetCommMask",
   "SetCommState",
   "SetCommTimeouts",
   "SetComputerName",
   "SetComputerNameEx",
   "SetConsoleActiveScreenBuffer",
   "SetConsoleCP",
   "SetConsoleCtrlHandler",
   "SetConsoleCursorInfo",
   "SetConsoleCursorPosition",
   "SetConsoleHistoryInfo",
   "SetConsoleMode",
   "SetConsoleOutputCP",
   "SetConsoleScreenBufferInfoEx",
   "SetConsoleScreenBufferSize",
   "SetConsoleTextAttribute",
   "SetConsoleTitle",
   "SetConsoleWindowInfo",
   "SetCriticalSectionSpinCount",
   "SetCurrentConsoleFontEx",
   "SetCurrentDirectory",
   "SetCursor",
   "SetCursorPos",
   "SetDCBrushColor",
   "SetDCPenColor",
   "SetDefaultCommConfig",
   "SetDefaultPrinter",
   "SetDIBColorTable",
   "SetDIBits",
   "SetDIBitsToDevice",
   "SetDlgItemInt",
   "SetDlgItemText",
   "SetDllDirectory",
   "SetDoubleClickTime",
   "SetDynamicTimeZoneInformation",
   "SetEndOfFile",
   "SetEnhMetaFileBits",
   "SetEnvironmentVariable",
   "SetErrorMode",
   "SetEvent",
   "SetEventWhenCallbackReturns",
   "SetFileApisToANSI",
   "SetFileApisToOEM",
   "SetFileAttributes",
   "SetFileBandwidthReservation",
   "SetFileCompletionNotificationModes",
   "SetFileInformationByHandle",
   "SetFileIoOverlappedRange",
   "SetFilePointer",
   "SetFilePointerEx",
   "SetFileShortName",
   "SetFileTime",
   "SetFileValidData",
   "SetFocus",
   "SetForegroundWindow",
   "SetForm",
   "SetGraphicsMode",
   "SetInformationJobObject",
   "SetJob",
   "SetKeyboardState",
   "SetLastError",
   "SetLastErrorEx",
   "SetLayeredWindowAttributes",
   "SetLayout",
   "SetLocaleInfo",
   "SetLocalTime",
   "SetMailslotInfo",
   "SetMapMode",
   "SetMapperFlags",
   "SetMenu",
   "SetMenuDefaultItem",
   "SetMenuInfo",
   "SetMenuItemBitmaps",
   "SetMenuItemInfo",
   "SetMessageExtraInfo",
   "SetMetaFileBitsEx",
   "SetMetaRgn",
   "SetMiterLimit",
   "SetNamedPipeHandleState",
   "SetNtmsDeviceChangeDetection",
   "SetNtmsMediaComplete",
   "SetNtmsObjectAttribute",
   "SetNtmsObjectInformation",
   "SetNtmsObjectSecurity",
   "SetNtmsRequestOrder",
   "SetNtmsUIOptions",
   "SetPaletteEntries",
   "SetParent",
   "SetPhysicalCursorPos",
   "SetPixel",
   "SetPixelV",
   "SetPolyFillMode",
   "SetPort",
   "SetPrinter",
   "SetPrinterData",
   "SetPrinterDataEx",
   "SetPriorityClass",
   "SetProcessAffinityMask",
   "SetProcessDefaultLayout",
   "SetProcessPriorityBoost",
   "SetProcessShutdownParameters",
   "SetProcessWindowStation",
   "SetProcessWorkingSetSize",
   "SetProcessWorkingSetSizeEx",
   "SetProp",
   "SetProviderStatusFunc",
   "SetProviderStatusInfoFreeFunc",
   "SetRect",
   "SetRectEmpty",
   "SetRectRgn",
   "SetROP2",
   "SetScrollInfo",
   "SetScrollPos",
   "SetScrollRange",
   "SetServiceBits",
   "SetServiceStatus",
   "SetStdHandle",
   "SetStretchBltMode",
   "SetSuspendState",
   "SetSysColors",
   "SetSystemCursor",
   "SetSystemFileCacheSize",
   "SetSystemPaletteUse",
   "SetSystemPowerState",
   "SetSystemTime",
   "SetSystemTimeAdjustment",
   "SetTapeParameters",
   "SetTapePosition",
   "SetTextAlign",
   "SetTextCharacterExtra",
   "SetTextColor",
   "SetTextJustification",
   "SetThreadAffinityMask",
   "SetThreadContext",
   "SetThreadDesktop",
   "SetThreadExecutionState",
   "SetThreadIdealProcessor",
   "SetThreadLocale",
   "SetThreadpoolCallbackCleanupGroup",
   "SetThreadpoolCallbackLibrary",
   "SetThreadpoolCallbackPool",
   "SetThreadpoolCallbackRunsLong",
   "SetThreadpoolThreadMaximum",
   "SetThreadpoolThreadMinimum",
   "SetThreadpoolTimer",
   "SetThreadpoolWait",
   "SetThreadPriority",
   "SetThreadPriorityBoost",
   "SetThreadStackGuarantee",
   "SetTimer",
   "SetTimeZoneInformation",
   "SetTraceCallback",
   "SetUnhandledExceptionFilter",
   "SetupComm",
   "SetUserFileEncryptionKey",
   "SetUserGeoID",
   "SetUserObjectInformation",
   "SetViewportExtEx",
   "SetViewportOrgEx",
   "SetVolumeLabel",
   "SetVolumeMountPoint",
   "SetWaitableTimer",
   "SetWindowExtEx",
   "SetWindowLong",
   "SetWindowLongPtr",
   "SetWindowOrgEx",
   "SetWindowPlacement",
   "SetWindowPos",
   "SetWindowRgn",
   "SetWindowsHookEx",
   "SetWindowText",
   "SetWinMetaFileBits",
   "SetWorldTransform",
   "SHAddDefaultPropertiesByExt",
   "SHAddToRecentDocs",
   "SHAppBarMessage",
   "SHAssocEnumHandlers",
   "SHBindToFolderIDListParent",
   "SHBindToFolderIDListParentEx",
   "SHBindToObject",
   "SHBindToParent",
   "SHBrowseForFolder",
   "SHChangeNotify",
   "SHChangeNotifyRegisterThread",
   "SHCreateAssociationRegistration",
   "SHCreateDataObject",
   "SHCreateDefaultContextMenu",
   "SHCreateDefaultExtractIcon",
   "SHCreateDefaultPropertiesOp",
   "SHCreateDirectory",
   "SHCreateDirectoryEx",
   "SHCreateItemFromIDList",
   "SHCreateItemFromParsingName",
   "SHCreateItemFromRelativeName",
   "SHCreateItemInKnownFolder",
   "SHCreateItemWithParent",
   "SHCreateProcessAsUserW",
   "SHCreateShellFolderView",
   "SHCreateShellFolderViewEx",
   "SHCreateShellItem",
   "SHCreateShellItemArray",
   "SHCreateShellItemArrayFromDataObject",
   "SHCreateShellItemArrayFromIDLists",
   "SHCreateShellItemArrayFromShellItem",
   "SHDoDragDrop",
   "ShellAbout",
   "ShellExecute",
   "ShellExecuteEx",
   "SHEmptyRecycleBin",
   "SHEnumerateUnreadMailAccounts",
   "SHEvaluateSystemCommandTemplate",
   "SHFileOperation",
   "SHFormatDrive",
   "SHFreeNameMappings",
   "SHGetDataFromIDList",
   "SHGetDesktopFolder",
   "SHGetDiskFreeSpace",
   "SHGetDiskFreeSpaceEx",
   "SHGetDriveMedia",
   "SHGetFileInfo",
   "SHGetFolderLocation",
   "SHGetFolderPath",
   "SHGetFolderPathAndSubDir",
   "SHGetIconOverlayIndex",
   "SHGetIDListFromObject",
   "SHGetImageList",
   "SHGetInstanceExplorer",
   "SHGetKnownFolderIDList",
   "SHGetKnownFolderPath",
   "SHGetLocalizedName",
   "SHGetNameFromIDList",
   "SHGetNameFromPropertyKey",
   "SHGetNewLinkInfo",
   "SHGetPathFromIDList",
   "SHGetPathFromIDListEx",
   "SHGetPropertyStoreFromIDList",
   "SHGetPropertyStoreFromParsingName",
   "SHGetSettings",
   "SHGetSpecialFolderLocation",
   "SHGetSpecialFolderPath",
   "SHGetStockIconInfo",
   "SHGetTemporaryPropertyForItem",
   "SHGetUnreadMailCount",
   "SHInvokePrinterCommand",
   "SHIsFileAvailableOffline",
   "SHLoadNonloadedIconOverlayIdentifiers",
   "SHLocalStrDup",
   "SHOpenFolderAndSelectItems",
   "SHOpenWithDialog",
   "ShowCaret",
   "ShowCursor",
   "ShowOwnedPopups",
   "ShowScrollBar",
   "ShowWindow",
   "ShowWindowAsync",
   "SHParseDisplayName",
   "SHPathPrepareForWrite",
   "SHQueryRecycleBin",
   "SHQueryUserNotificationState",
   "SHRegGetBoolValueFromHKCUHKLM",
   "SHRegGetValueFromHKCUHKLM",
   "SHRemoveLocalizedName",
   "SHSetDefaultProperties",
   "SHSetFolderPath",
   "SHSetKnownFolderPath",
   "SHSetLocalizedName",
   "SHSetTemporaryPropertyForItem",
   "SHSetUnreadMailCount",
   "SHTestTokenMembership",
   "SHUpdateImage",
   "ShutdownBlockReasonCreate",
   "ShutdownBlockReasonDestroy",
   "ShutdownBlockReasonQuery",
   "SignalObjectAndWait",
   "SisCreateBackupStructure",
   "SisCreateRestoreStructure",
   "SisCSFilesToBackUpForLink",
   "SisFreeAllocatedMemory",
   "SisFreeBackupStructure",
   "SisFreeRestoreStructure",
   "SisRestoredCommonStoreFile",
   "SisRestoredLink",
   "SizeofResource",
   "Sleep",
   "SleepConditionVariableCS",
   "SleepConditionVariableSRW",
   "SleepEx",
   "StartDoc",
   "StartDocPrinter",
   "StartPage",
   "StartPagePrinter",
   "StartService",
   "StartServiceCtrlDispatcher",
   "StartThreadpoolIo",
   "StartTrace",
   "StopTrace",
   "StretchBlt",
   "StretchDIBits",
   "StringCbCat",
   "StringCbCatEx",
   "StringCbCatN",
   "StringCbCatNEx",
   "StringCbCopy",
   "StringCbCopyEx",
   "StringCbCopyN",
   "StringCbCopyNEx",
   "StringCbGets",
   "StringCbGetsEx",
   "StringCbLength",
   "StringCbPrintf",
   "StringCbPrintfEx",
   "StringCbVPrintf",
   "StringCbVPrintfEx",
   "StringCchCat",
   "StringCchCatEx",
   "StringCchCatN",
   "StringCchCatNEx",
   "StringCchCopy",
   "StringCchCopyEx",
   "StringCchCopyN",
   "StringCchCopyNEx",
   "StringCchGets",
   "StringCchGetsEx",
   "StringCchLength",
   "StringCchPrintf",
   "StringCchPrintfEx",
   "StringCchVPrintf",
   "StringCchVPrintfEx",
   "StrokeAndFillPath",
   "StrokePath",
   "SubmitNtmsOperatorRequest",
   "SubmitThreadpoolWork",
   "SubtractRect",
   "SuspendThread",
   "SwapMouseButton",
   "SwapNtmsMedia",
   "SwitchDesktop",
   "SwitchToFiber",
   "SwitchToThisWindow",
   "SwitchToThread",
   "SysMsgProc",
   "SystemParametersInfo",
   "SystemTimeToFileTime",
   "SystemTimeToTzSpecificLocalTime",
   "TabbedTextOut",
   "TaskDialog",
   "TaskDialogIndirect",
   "TerminateJobObject",
   "TerminateProcess",
   "TerminateThread",
   "TextOut",
   "Thread32First",
   "Thread32Next",
   "ThreadProc",
   "TileWindows",
   "TimeProvClose",
   "TimeProvCommand",
   "TimeProvOpen",
   "TimerAPCProc",
   "TimerProc",
   "TlsAlloc",
   "TlsFree",
   "TlsGetValue",
   "TlsSetValue",
   "ToAscii",
   "ToAsciiEx",
   "Toolhelp32ReadProcessMemory",
   "ToUnicode",
   "ToUnicodeEx",
   "TraceEvent",
   "TraceEventInstance",
   "TraceMessage",
   "TraceMessageVa",
   "TrackMouseEvent",
   "TrackPopupMenu",
   "TrackPopupMenuEx",
   "TransactNamedPipe",
   "TranslateAccelerator",
   "TranslateMDISysAccel",
   "TranslateMessage",
   "TranslateName",
   "TransmitCommChar",
   "TransparentBlt",
   "TryEnterCriticalSection",
   "TrySubmitThreadpoolCallback",
   "TzSpecificLocalTimeToSystemTime",
   "UnhandledExceptionFilter",
   "UnhookWindowsHookEx",
   "UnionRect",
   "UnloadKeyboardLayout",
   "UnloadPerfCounterTextStrings",
   "UnlockFile",
   "UnlockFileEx",
   "UnlockServiceDatabase",
   "UnmapViewOfFile",
   "UnpackDDElParam",
   "UnrealizeObject",
   "UnregisterApplicationRecoveryCallback",
   "UnregisterApplicationRestart",
   "UnregisterClass",
   "UnregisterDeviceNotification",
   "UnregisterHotKey",
   "UnregisterPowerSettingNotification",
   "UnregisterTraceGuids",
   "UnregisterWait",
   "UnregisterWaitEx",
   "UpdateColors",
   "UpdateLayeredWindow",
   "UpdateNtmsOmidInfo",
   "UpdateProcThreadAttribute",
   "UpdateResource",
   "UpdateTrace",
   "UpdateWindow",
   "UserHandleGrantAccess",
   "ValidateRect",
   "ValidateRgn",
   "VectoredHandler",
   "VerFindFile",
   "VerifyVersionInfo",
   "VerInstallFile",
   "VerLanguageName",
   "VerQueryValue",
   "VerSetConditionMask",
   "VirtualAlloc",
   "VirtualAllocEx",
   "VirtualAllocExNuma",
   "VirtualFree",
   "VirtualFreeEx",
   "VirtualLock",
   "VirtualProtect",
   "VirtualProtectEx",
   "VirtualQuery",
   "VirtualQueryEx",
   "VirtualUnlock",
   "VkKeyScan",
   "VkKeyScanEx",
   "WaitCommEvent",
   "WaitForDebugEvent",
   "WaitForInputIdle",
   "WaitForMultipleObjects",
   "WaitForMultipleObjectsEx",
   "WaitForNtmsNotification",
   "WaitForNtmsOperatorRequest",
   "WaitForSingleObject",
   "WaitForSingleObjectEx",
   "WaitForThreadpoolIoCallbacks",
   "WaitForThreadpoolTimerCallbacks",
   "WaitForThreadpoolWaitCallbacks",
   "WaitForThreadpoolWorkCallbacks",
   "WaitMessage",
   "WaitNamedPipe",
   "WaitOrTimerCallback",
   "WakeAllConditionVariable",
   "WakeConditionVariable",
   "WerAddExcludedApplication",
   "WerGetFlags",
   "WerRegisterFile",
   "WerRegisterMemoryBlock",
   "WerRemoveExcludedApplication",
   "WerReportAddDump",
   "WerReportAddFile",
   "WerReportCloseHandle",
   "WerReportCreate",
   "WerReportSetParameter",
   "WerReportSetUIOption",
   "WerReportSubmit",
   "WerSetFlags",
   "WerUnregisterFile",
   "WerUnregisterMemoryBlock",
   "WidenPath",
   "WideCharToMultiByte",
   "WindowFromDC",
   "WindowFromPoint",
   "WindowProc",
   "WinExec",
   "WinMain",
   "WNetAddConnection",
   "WNetAddConnection2",
   "WNetAddConnection3",
   "WNetCancelConnection",
   "WNetCancelConnection2",
   "WNetCloseEnum",
   "WNetConnectionDialog",
   "WNetConnectionDialog1",
   "WNetDisconnectDialog",
   "WNetDisconnectDialog1",
   "WNetEnumResource",
   "WNetGetConnection",
   "WNetGetLastError",
   "WNetGetNetworkInformation",
   "WNetGetProviderName",
   "WNetGetResourceInformation",
   "WNetGetResourceParent",
   "WNetGetUniversalName",
   "WNetGetUser",
   "WNetOpenEnum",
   "WNetUseConnection",
   "Wow64DisableWow64FsRedirection",
   "Wow64EnableWow64FsRedirection",
   "Wow64GetThreadContext",
   "Wow64RevertWow64FsRedirection",
   "Wow64SetThreadContext",
   "Wow64SuspendThread",
   "WriteConsole",
   "WriteConsoleInput",
   "WriteConsoleOutput",
   "WriteConsoleOutputAttribute",
   "WriteConsoleOutputCharacter",
   "WriteFile",
   "WriteFileEx",
   "WriteFileGather",
   "WriteGlobalPwrPolicy",
   "WritePrinter",
   "WritePrivateProfileSection",
   "WritePrivateProfileString",
   "WritePrivateProfileStruct",
   "WriteProcessMemory",
   "WriteProcessorPwrScheme",
   "WriteProfileSection",
   "WriteProfileString",
   "WritePwrScheme",
   "WriteTapemark",
   "wsprintf",
   "wvsprintf",
   "ZeroMemory",
}

def load_win32_functions_from_file(file_path):
    """Load Win32 functions from a text file (one per line)"""
    if not os.path.exists(file_path):
        print(f"Warning: Win32 functions file not found at {file_path}")
        return WIN32_FUNCTIONS
    
    with open(file_path, 'r') as f:
        return {line.strip() for line in f if line.strip()}

def scan_file(file_path, win32_funcs, win32_hdrs):
    """Scan a single source file for Win32 API usage"""
    results = {
        'file': file_path,
        'headers': set(),
        'functions': set(),
        'lines': {}
    }
    
    try:
        with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
            print(f"Scanning {file_path}...")
            for line_num, line in enumerate(f, 1):
                # Check for Win32 headers
                header_match = re.search(r'#include\s*[<"]([^>"]+)[>"]', line)
                if header_match:
                    header = header_match.group(1).lower()
                    if header in win32_hdrs:
                        results['headers'].add(header)
                
                # Check for Win32 function calls
                for func in win32_funcs:
                    # Pattern to match function calls but not declarations
                    if re.search(rf'\b{func}\s*\(', line):
                        results['functions'].add(func)
                        results['lines'].setdefault(func, []).append(line_num)
    
    except Exception as e:
        print(f"Error scanning {file_path}: {e}")
    
    return results

def scan_directory(directory, win32_funcs, win32_hdrs, recursive=False):
    """Scan a directory for Win32 API usage in source files"""
    found = []
    extensions = {'.h', '.hpp', '.c', '.cpp', '.cc', '.cxx'}
    
    for root, _, files in os.walk(directory):
        for file in files:
            if Path(file).suffix.lower() in extensions:
                file_path = os.path.join(root, file)
                results = scan_file(file_path, win32_funcs, win32_hdrs)
                if results['headers'] or results['functions']:
                    found.append(results)
        
        if not recursive:
            break  # Only process top-level directory
    
    return found

def print_results(results, verbose=False):
    """Print scan results in a readable format"""
    for result in results:
        print(f"\nFile: {result['file']}")
        
        if result['headers']:
            print("  Win32 Headers:")
            for header in sorted(result['headers']):
                print(f"    - {header}")
        
        if result['functions']:
            print("  Win32 Functions:")
            for func in sorted(result['functions']):
                if verbose and func in result['lines']:
                    lines = ', '.join(map(str, result['lines'][func]))
                    print(f"    - {func} (lines: {lines})")
                else:
                    print(f"    - {func}")

def main():
    parser = argparse.ArgumentParser(
        description='Scan source files for Win32 API usage'
    )
    parser.add_argument('directory', help='Directory to scan')
    parser.add_argument('--recursive', '-r', action='store_true',
                       help='Scan subdirectories recursively')
    parser.add_argument('--verbose', '-v', action='store_true',
                       help='Show line numbers where functions are called')
    parser.add_argument('--functions-file', default='win32_functions.txt',
                       help='Text file containing Win32 functions (one per line)')
    args = parser.parse_args()

    # Load Win32 functions (either from file or built-in set)
    win32_funcs = load_win32_functions_from_file(args.functions_file)
    
    print(f"Scanning {args.directory} {'recursively' if args.recursive else ''}")
    print(f"Checking for {len(win32_funcs)} Win32 functions and {len(WIN32_HEADERS)} headers")
    
    results = scan_directory(
        args.directory,
        WIN32_FUNCTIONS,
        WIN32_HEADERS,
        args.recursive
    )
    
    print_results(results, args.verbose)
    
    # Summary
    total_files = len(results)
    total_funcs = sum(len(r['functions']) for r in results)
    print(f"\nScan complete. Found {total_funcs} Win32 API calls in {total_files} files.")

if __name__ == '__main__':
    main()
